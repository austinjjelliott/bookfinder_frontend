{"ast":null,"code":"import axios from \"axios\";\nconst BASE_URL = \"http://localhost:3001\";\nconst GOOGLE_BOOKS_API_URL = \"https://www.googleapis.com/books/v1/volumes\";\nconst MAPQUEST_API_URL = \"https://www.mapquestapi.com/search/v2/radius\";\nconst MAPQUEST_API_KEY = \"vIzRjqvib9fNtg4U067gRG0MuLSlfhsU\";\nclass BooklyAPI {\n  // Set the JWT token for authorization\n  static setToken(token) {\n    this.token = token;\n  }\n\n  // Generic request method\n  static async request(endpoint, data = {}, method = \"get\") {\n    const url = `${BASE_URL}/${endpoint}`;\n    const headers = this.token ? {\n      Authorization: `Bearer ${this.token}`\n    } : {};\n    const params = method === \"get\" ? data : {};\n    try {\n      const response = await axios({\n        url,\n        method,\n        data,\n        params,\n        headers\n      });\n      return response.data;\n    } catch (err) {\n      console.error(\"API Error:\", err.response);\n      throw err.response.data;\n    }\n  }\n\n  // User-related API calls to LOCAL backend\n  static async login(credentials) {\n    const res = await this.request(\"auth/token\", credentials, \"post\");\n    return res.token;\n  }\n  static async register(userData) {\n    const res = await this.request(\"auth/register\", userData, \"post\");\n    return res.token;\n  }\n  static async getUser(username) {\n    const res = await this.request(`users/${username}`);\n    // console.log(\"Full response:\", res); // DEBUGGING\n    return res;\n  }\n  static async updateUser(username, userData) {\n    const res = await this.request(`users/${username}`, userData, \"patch\");\n    console.log(\"API Response after profile update:\", res); // Log the response to verify\n    return res;\n  }\n\n  // Book-related API calls to LOCAL backend\n\n  static async addFavorite(bookData) {\n    const res = await this.request(\"books/favorite\", bookData, \"post\");\n    return res.favorite;\n  }\n  static async getFavorites() {\n    const res = await this.request(\"books/favorites\");\n    return res.favorites;\n  }\n  static async removeFavorite(bookId) {\n    const res = await this.request(`books/favorite/${bookId}`, {}, \"delete\");\n    return res.deleted;\n  }\n  static async updateFavorites(username, favorites) {\n    const response = await fetch(`http://localhost:3001/users/${username}/favorites`, {\n      method: \"PATCH\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${localStorage.getItem(\"token\")}` // Assuming JWT token\n      },\n      body: JSON.stringify({\n        favorites\n      })\n    });\n    if (!response.ok) {\n      throw new Error(\"Error updating favorites\");\n    }\n    const data = await response.json();\n    return data.favorites; // Return the updated favorites list\n  }\n\n  // Google Books API call\n  static async searchBooks(query) {\n    try {\n      const response = await axios.get(GOOGLE_BOOKS_API_URL, {\n        params: {\n          q: query,\n          maxResults: 25\n        }\n      });\n      return response.data.items.map(book => {\n        var _book$volumeInfo$imag;\n        return {\n          id: book.id,\n          title: book.volumeInfo.title,\n          authors: book.volumeInfo.authors || [],\n          description: book.volumeInfo.description || \"No description available\",\n          thumbnail: ((_book$volumeInfo$imag = book.volumeInfo.imageLinks) === null || _book$volumeInfo$imag === void 0 ? void 0 : _book$volumeInfo$imag.thumbnail) || null,\n          pageCount: book.volumeInfo.pageCount,\n          publishedDate: book.volumeInfo.publishedDate\n        };\n      });\n    } catch (err) {\n      console.error(\"Books API Error:\", err.response);\n      throw err.response.data;\n    }\n  }\n  static async getSingleBook(id) {\n    try {\n      const response = await axios.get(`${GOOGLE_BOOKS_API_URL}/${id}`);\n      return response.data;\n    } catch (err) {\n      console.error(\"Book detail API Error:\", err.response);\n      throw err.response.data;\n    }\n  }\n\n  //MAPQUEST PLACES API CALL:\n  static async searchPlaces(query) {\n    try {\n      const geocodeResponse = await axios.get(\"https://open.mapquestapi.com/geocoding/v1/address\", {\n        params: {\n          key: MAPQUEST_API_KEY,\n          location: query\n        }\n      });\n      // Extract the lat/lng from the geocoding result\n      const lat = geocodeResponse.data.results[0].locations[0].latLng.lat;\n      const lng = geocodeResponse.data.results[0].locations[0].latLng.lng;\n      //Use lat and lng to find bookstores nearby\n      const placesResponse = await axios.get(MAPQUEST_API_URL, {\n        params: {\n          key: MAPQUEST_API_KEY,\n          origin: `${lat},${lng}`,\n          // Use lat/lng as the origin\n          radius: 10,\n          // Search within a 10-mile radius (adjust as needed)\n          maxMatches: 5,\n          // Limit to 5 results\n          ambiguities: \"ignore\",\n          // Ignore ambiguous results\n          query: \"bookstore\" // Search specifically for bookstores\n        }\n      });\n      return placesResponse.data.results;\n    } catch (err) {\n      console.error(\"MAPQUEST API error:\", err.response);\n    }\n  }\n\n  // //FIrst...\n  // static async searchPlaces(query) {\n  //   try {\n  //     const response = await axios.get(MAPQUEST_API_URL, {\n  //       params: {\n  //         query: `bookstores in ${query}`,\n  //         key: MAPQUEST_API_KEY,\n  //       },\n  //     });\n  //     return response.data.results;\n  //   } catch (err) {\n  //     console.error(\"MAPQUEST Places API Error:\", err.response);\n  //     throw err.response?.data;\n  //   }\n  // }\n}\nexport default BooklyAPI;","map":{"version":3,"names":["axios","BASE_URL","GOOGLE_BOOKS_API_URL","MAPQUEST_API_URL","MAPQUEST_API_KEY","BooklyAPI","setToken","token","request","endpoint","data","method","url","headers","Authorization","params","response","err","console","error","login","credentials","res","register","userData","getUser","username","updateUser","log","addFavorite","bookData","favorite","getFavorites","favorites","removeFavorite","bookId","deleted","updateFavorites","fetch","localStorage","getItem","body","JSON","stringify","ok","Error","json","searchBooks","query","get","q","maxResults","items","map","book","_book$volumeInfo$imag","id","title","volumeInfo","authors","description","thumbnail","imageLinks","pageCount","publishedDate","getSingleBook","searchPlaces","geocodeResponse","key","location","lat","results","locations","latLng","lng","placesResponse","origin","radius","maxMatches","ambiguities"],"sources":["/Users/austinelliott/Springboard/Unit-50.Capstone2/capstone-project-two-e14219de7db4449bbc1f6df850e16946/bookfinder/src/api.js"],"sourcesContent":["import axios from \"axios\";\n\nconst BASE_URL = \"http://localhost:3001\";\nconst GOOGLE_BOOKS_API_URL = \"https://www.googleapis.com/books/v1/volumes\";\nconst MAPQUEST_API_URL = \"https://www.mapquestapi.com/search/v2/radius\";\nconst MAPQUEST_API_KEY = \"vIzRjqvib9fNtg4U067gRG0MuLSlfhsU\";\n\nclass BooklyAPI {\n  static token;\n\n  // Set the JWT token for authorization\n  static setToken(token) {\n    this.token = token;\n  }\n\n  // Generic request method\n  static async request(endpoint, data = {}, method = \"get\") {\n    const url = `${BASE_URL}/${endpoint}`;\n    const headers = this.token ? { Authorization: `Bearer ${this.token}` } : {};\n    const params = method === \"get\" ? data : {};\n\n    try {\n      const response = await axios({ url, method, data, params, headers });\n      return response.data;\n    } catch (err) {\n      console.error(\"API Error:\", err.response);\n      throw err.response.data;\n    }\n  }\n\n  // User-related API calls to LOCAL backend\n  static async login(credentials) {\n    const res = await this.request(\"auth/token\", credentials, \"post\");\n    return res.token;\n  }\n\n  static async register(userData) {\n    const res = await this.request(\"auth/register\", userData, \"post\");\n    return res.token;\n  }\n\n  static async getUser(username) {\n    const res = await this.request(`users/${username}`);\n    // console.log(\"Full response:\", res); // DEBUGGING\n    return res;\n  }\n\n  static async updateUser(username, userData) {\n    const res = await this.request(`users/${username}`, userData, \"patch\");\n    console.log(\"API Response after profile update:\", res); // Log the response to verify\n    return res;\n  }\n\n  // Book-related API calls to LOCAL backend\n\n  static async addFavorite(bookData) {\n    const res = await this.request(\"books/favorite\", bookData, \"post\");\n    return res.favorite;\n  }\n\n  static async getFavorites() {\n    const res = await this.request(\"books/favorites\");\n    return res.favorites;\n  }\n\n  static async removeFavorite(bookId) {\n    const res = await this.request(`books/favorite/${bookId}`, {}, \"delete\");\n    return res.deleted;\n  }\n\n  static async updateFavorites(username, favorites) {\n    const response = await fetch(\n      `http://localhost:3001/users/${username}/favorites`,\n      {\n        method: \"PATCH\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`, // Assuming JWT token\n        },\n        body: JSON.stringify({ favorites }),\n      }\n    );\n\n    if (!response.ok) {\n      throw new Error(\"Error updating favorites\");\n    }\n\n    const data = await response.json();\n    return data.favorites; // Return the updated favorites list\n  }\n\n  // Google Books API call\n  static async searchBooks(query) {\n    try {\n      const response = await axios.get(GOOGLE_BOOKS_API_URL, {\n        params: { q: query, maxResults: 25 },\n      });\n      return response.data.items.map((book) => ({\n        id: book.id,\n        title: book.volumeInfo.title,\n        authors: book.volumeInfo.authors || [],\n        description: book.volumeInfo.description || \"No description available\",\n        thumbnail: book.volumeInfo.imageLinks?.thumbnail || null,\n        pageCount: book.volumeInfo.pageCount,\n        publishedDate: book.volumeInfo.publishedDate,\n      }));\n    } catch (err) {\n      console.error(\"Books API Error:\", err.response);\n      throw err.response.data;\n    }\n  }\n\n  static async getSingleBook(id) {\n    try {\n      const response = await axios.get(`${GOOGLE_BOOKS_API_URL}/${id}`);\n      return response.data;\n    } catch (err) {\n      console.error(\"Book detail API Error:\", err.response);\n      throw err.response.data;\n    }\n  }\n\n  //MAPQUEST PLACES API CALL:\n  static async searchPlaces(query) {\n    try {\n      const geocodeResponse = await axios.get(\n        \"https://open.mapquestapi.com/geocoding/v1/address\",\n        {\n          params: {\n            key: MAPQUEST_API_KEY,\n            location: query,\n          },\n        }\n      );\n      // Extract the lat/lng from the geocoding result\n      const lat = geocodeResponse.data.results[0].locations[0].latLng.lat;\n      const lng = geocodeResponse.data.results[0].locations[0].latLng.lng;\n      //Use lat and lng to find bookstores nearby\n      const placesResponse = await axios.get(MAPQUEST_API_URL, {\n        params: {\n          key: MAPQUEST_API_KEY,\n          origin: `${lat},${lng}`, // Use lat/lng as the origin\n          radius: 10, // Search within a 10-mile radius (adjust as needed)\n          maxMatches: 5, // Limit to 5 results\n          ambiguities: \"ignore\", // Ignore ambiguous results\n          query: \"bookstore\", // Search specifically for bookstores\n        },\n      });\n      return placesResponse.data.results;\n    } catch (err) {\n      console.error(\"MAPQUEST API error:\", err.response);\n    }\n  }\n\n  // //FIrst...\n  // static async searchPlaces(query) {\n  //   try {\n  //     const response = await axios.get(MAPQUEST_API_URL, {\n  //       params: {\n  //         query: `bookstores in ${query}`,\n  //         key: MAPQUEST_API_KEY,\n  //       },\n  //     });\n  //     return response.data.results;\n  //   } catch (err) {\n  //     console.error(\"MAPQUEST Places API Error:\", err.response);\n  //     throw err.response?.data;\n  //   }\n  // }\n}\n\nexport default BooklyAPI;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}